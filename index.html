<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistem Kuisioner Divisi</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --primary: #4361ee;
        --secondary: #3f37c9;
        --success: #4cc9f0;
        --danger: #f72585;
        --warning: #f77f00;
        --light: #f8f9fa;
        --dark: #212529;
        --gray: #6c757d;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background-color: #f0f2f5;
        color: var(--dark);
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      .container {
        display: flex;
        flex: 1;
        min-height: calc(100vh - 60px); /* Adjust for footer height */
      }

      /* Sidebar Styles */
      .sidebar {
        width: 280px;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        padding: 20px 0;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        position: fixed;
        height: calc(100vh - 60px); /* Adjust for footer height */
        overflow-y: auto;
      }

      .logo {
        text-align: center;
        padding: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        margin-bottom: 20px;
      }

      .logo h2 {
        font-size: 1.5rem;
        margin-bottom: 5px;
      }

      .logo p {
        font-size: 0.9rem;
        opacity: 0.8;
      }

      .menu {
        list-style: none;
      }

      .menu-item {
        padding: 15px 25px;
        display: flex;
        align-items: center;
        cursor: pointer;
        transition: all 0.3s;
        border-left: 3px solid transparent;
      }

      .menu-item:hover {
        background: rgba(255, 255, 255, 0.1);
        border-left: 3px solid var(--success);
      }

      .menu-item.active {
        background: rgba(255, 255, 255, 0.2);
        border-left: 3px solid var(--success);
      }

      .menu-item i {
        margin-right: 15px;
        font-size: 1.2rem;
        width: 20px;
        text-align: center;
      }

      .user-info {
        position: absolute;
        bottom: 0;
        width: 100%;
        padding: 20px;
        background: rgba(0, 0, 0, 0.2);
        display: flex;
        align-items: center;
      }

      .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--warning);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 15px;
        font-weight: bold;
      }

      /* Main Content */
      .main-content {
        margin-left: 280px;
        padding: 30px;
        width: calc(100% - 280px);
        flex: 1;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 1px solid #e0e0e0;
      }

      .header h1 {
        font-size: 1.8rem;
        color: var(--dark);
      }

      .header .logout-btn {
        background: var(--danger);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s;
      }

      .header .logout-btn:hover {
        background: #d0004f;
        transform: translateY(-2px);
      }

      /* Card Styles */
      .card {
        background: white;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        padding: 25px;
        margin-bottom: 25px;
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #eee;
      }

      .card-title {
        font-size: 1.3rem;
        font-weight: 600;
        color: var(--dark);
      }

      /* Form Styles */
      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--dark);
      }

      .form-control {
        width: 100%;
        padding: 12px 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 1rem;
        transition: all 0.3s;
      }

      .form-control:focus {
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        outline: none;
      }

      .btn {
        padding: 12px 25px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s;
        display: inline-block;
      }

      .btn-primary {
        background: var(--primary);
        color: white;
      }

      .btn-primary:hover {
        background: var(--secondary);
        transform: translateY(-2px);
      }

      .btn-success {
        background: var(--success);
        color: white;
      }

      .btn-success:hover {
        background: #00a8cc;
      }

      .btn-danger {
        background: var(--danger);
        color: white;
      }

      .btn-danger:hover {
        background: #d0004f;
      }

      .btn-warning {
        background: var(--warning);
        color: white;
      }

      .btn-warning:hover {
        background: #e67700;
      }

      .btn-sm {
        padding: 8px 15px;
        font-size: 0.875rem;
      }

      /* Question Styles */
      .question {
        margin-bottom: 25px;
        padding-bottom: 20px;
        border-bottom: 1px solid #eee;
      }

      .question:last-child {
        border-bottom: none;
      }

      .question-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 15px;
        color: var(--dark);
      }

      .options {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .option {
        display: flex;
        align-items: center;
        padding: 10px 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .option:hover {
        background: #f8f9fa;
        border-color: var(--primary);
      }

      .option input {
        margin-right: 10px;
      }

      /* Table Styles */
      .table-container {
        overflow-x: auto;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      th,
      td {
        padding: 12px 15px;
        text-align: left;
        border-bottom: 1px solid #eee;
      }

      th {
        background: #f8f9fa;
        font-weight: 600;
        color: var(--dark);
      }

      tr:hover {
        background: #f8f9fa;
      }

      /* Login Page */
      .login-container {
        max-width: 400px;
        margin: 100px auto;
        padding: 30px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .login-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .login-header h1 {
        color: var(--primary);
        margin-bottom: 10px;
      }

      .login-header p {
        color: var(--gray);
      }

      .division-selector {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-bottom: 20px;
      }

      .division-option {
        padding: 15px;
        border: 2px solid #ddd;
        border-radius: 8px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s;
      }

      .division-option:hover {
        border-color: var(--primary);
        background: rgba(67, 97, 238, 0.05);
      }

      .division-option.selected {
        border-color: var(--primary);
        background: rgba(67, 97, 238, 0.1);
        color: var(--primary);
        font-weight: 600;
      }

      .division-option i {
        font-size: 2rem;
        margin-bottom: 10px;
        display: block;
      }

      /* Responsive */
      @media (max-width: 992px) {
        .sidebar {
          width: 250px;
        }

        .main-content {
          margin-left: 250px;
          width: calc(100% - 250px);
        }
      }

      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
          z-index: 1000;
        }

        .sidebar.active {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0;
          width: 100%;
        }

        .division-selector {
          grid-template-columns: 1fr;
        }
      }

      /* Notification */
      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        background: white;
        border-left: 4px solid var(--success);
        border-radius: 5px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        display: flex;
        align-items: center;
        transform: translateX(120%);
        transition: transform 0.3s ease;
      }

      .notification.show {
        transform: translateX(0);
      }

      .notification i {
        margin-right: 10px;
        color: var(--success);
      }

      .notification.error {
        border-left-color: var(--danger);
      }

      .notification.error i {
        color: var(--danger);
      }

      /* Loading */
      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: white;
        animation: spin 1s ease-in-out infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Badge Styles */
      .badge {
        display: inline-block;
        padding: 3px 10px;
        font-size: 0.75rem;
        font-weight: 700;
        line-height: 1;
        text-align: center;
        white-space: nowrap;
        vertical-align: baseline;
        border-radius: 10px;
      }

      .badge-success {
        color: #fff;
        background-color: #28a745;
      }

      /* Access Denied */
      .access-denied {
        text-align: center;
        padding: 50px 20px;
      }

      .access-denied i {
        font-size: 5rem;
        color: var(--danger);
        margin-bottom: 20px;
      }

      .access-denied h2 {
        color: var(--dark);
        margin-bottom: 15px;
      }

      .access-denied p {
        color: var(--gray);
        margin-bottom: 30px;
      }

      /* Admin indicator */
      .admin-indicator {
        display: inline-block;
        margin-left: 8px;
        padding: 2px 6px;
        background: var(--danger);
        color: white;
        border-radius: 4px;
        font-size: 0.7rem;
        font-weight: bold;
      }

      /* Profile Card */
      .profile-card {
        max-width: 600px;
        margin: 0 auto;
      }

      .profile-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .profile-avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: var(--primary);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        font-size: 2.5rem;
        font-weight: bold;
      }

      .profile-info {
        text-align: center;
        margin-bottom: 20px;
      }

      .profile-info h3 {
        font-size: 1.5rem;
        margin-bottom: 5px;
      }

      .profile-info p {
        color: var(--gray);
      }

      /* Footer Styles */
      .footer {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        padding: 15px 0;
        text-align: center;
        width: 100%;
        height: 60px;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .footer-content {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .footer-copyright {
        font-size: 0.9rem;
        margin-bottom: 5px;
      }

      .footer-links {
        display: flex;
        gap: 15px;
        font-size: 0.8rem;
      }

      .footer-links a {
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: color 0.3s;
      }

      .footer-links a:hover {
        color: white;
      }

      .footer-divider {
        color: rgba(255, 255, 255, 0.5);
      }
    </style>
  </head>
  <body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container">
      <div class="login-header">
        <h1><i class="fas fa-clipboard-list"></i> Sistem Kuisioner</h1>
        <p>Silakan login untuk mengakses sistem</p>
      </div>

      <form id="loginForm">
        <div class="form-group">
          <label>Username</label>
          <input
            type="text"
            id="loginUsername"
            class="form-control"
            placeholder="Masukkan username"
            required
          />
        </div>

        <div class="form-group">
          <label>Password</label>
          <input
            type="password"
            id="loginPassword"
            class="form-control"
            placeholder="Masukkan password"
            required
          />
        </div>

        <div class="form-group">
          <label>Divisi</label>
          <div class="division-selector">
            <div class="division-option" data-division="admin">
              <i class="fas fa-user-shield"></i>
              <span>Administrator</span>
            </div>
            <div class="division-option" data-division="keuangan">
              <i class="fas fa-coins"></i>
              <span>Keuangan</span>
            </div>
            <div class="division-option" data-division="project">
              <i class="fas fa-project-diagram"></i>
              <span>Project</span>
            </div>
            <div class="division-option" data-division="humas">
              <i class="fas fa-users"></i>
              <span>Humas</span>
            </div>
            <div class="division-option" data-division="teknik">
              <i class="fas fa-cogs"></i>
              <span>Teknik</span>
            </div>
          </div>
          <input type="hidden" id="loginDivision" required />
        </div>

        <button type="submit" class="btn btn-primary" style="width: 100%">
          Login
        </button>
      </form>

      <div style="text-align: center; margin-top: 20px">
        <p>
          Belum punya akun? <a href="#" id="showRegisterForm">Daftar di sini</a>
        </p>
      </div>
    </div>

    <!-- Register Form (Hidden by default) -->
    <div id="registerForm" class="login-container" style="display: none">
      <div class="login-header">
        <h1><i class="fas fa-user-plus"></i> Buat Akun Baru</h1>
        <p>Isi data untuk membuat akun baru</p>
      </div>

      <form id="registerFormElement">
        <div class="form-group">
          <label>Username</label>
          <input
            type="text"
            id="registerUsername"
            class="form-control"
            placeholder="Masukkan username"
            required
          />
        </div>

        <div class="form-group">
          <label>Password</label>
          <input
            type="password"
            id="registerPassword"
            class="form-control"
            placeholder="Masukkan password"
            required
          />
        </div>

        <div class="form-group">
          <label>Konfirmasi Password</label>
          <input
            type="password"
            id="registerConfirmPassword"
            class="form-control"
            placeholder="Konfirmasi password"
            required
          />
        </div>

        <div class="form-group">
          <label>Divisi</label>
          <div class="division-selector">
            <div class="division-option" data-division="keuangan">
              <i class="fas fa-coins"></i>
              <span>Keuangan</span>
            </div>
            <div class="division-option" data-division="project">
              <i class="fas fa-project-diagram"></i>
              <span>Project</span>
            </div>
            <div class="division-option" data-division="humas">
              <i class="fas fa-users"></i>
              <span>Humas</span>
            </div>
            <div class="division-option" data-division="teknik">
              <i class="fas fa-cogs"></i>
              <span>Teknik</span>
            </div>
          </div>
          <input type="hidden" id="registerDivision" required />
        </div>

        <div style="display: flex; gap: 10px">
          <button type="submit" class="btn btn-success" style="flex: 1">
            Daftar
          </button>
          <button
            type="button"
            id="cancelRegister"
            class="btn btn-danger"
            style="flex: 1"
          >
            Batal
          </button>
        </div>
      </form>
    </div>

    <!-- Main Application -->
    <div id="appContainer" class="container" style="display: none">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="logo">
          <h2><i class="fas fa-clipboard-list"></i> Kuisioner</h2>
          <p>Sistem Penilaian Divisi</p>
        </div>

        <ul class="menu" id="sidebarMenu">
          <li class="menu-item" data-page="dashboard">
            <i class="fas fa-tachometer-alt"></i>
            <span>Dashboard</span>
          </li>
          <li
            class="menu-item division-menu"
            data-division="keuangan"
            data-page="keuangan"
          >
            <i class="fas fa-coins"></i>
            <span>Keuangan</span>
          </li>
          <li
            class="menu-item division-menu"
            data-division="project"
            data-page="project"
          >
            <i class="fas fa-project-diagram"></i>
            <span>Project</span>
          </li>
          <li
            class="menu-item division-menu"
            data-division="humas"
            data-page="humas"
          >
            <i class="fas fa-users"></i>
            <span>Humas</span>
          </li>
          <li
            class="menu-item division-menu"
            data-division="teknik"
            data-page="teknik"
          >
            <i class="fas fa-cogs"></i>
            <span>Teknik</span>
          </li>
          <li
            class="menu-item admin-only"
            data-page="admin"
            style="display: none"
          >
            <i class="fas fa-user-shield"></i>
            <span>Admin</span>
          </li>
          <li
            class="menu-item admin-only"
            data-page="manage-users"
            style="display: none"
          >
            <i class="fas fa-users-cog"></i>
            <span>Kelola Akun</span>
          </li>
          <li
            class="menu-item admin-only"
            data-page="profile"
            style="display: none"
          >
            <i class="fas fa-user-edit"></i>
            <span>Ubah Profil</span>
          </li>
        </ul>

        <div class="user-info">
          <div class="user-avatar" id="userAvatar">U</div>
          <div>
            <div id="currentUser">User</div>
            <div id="currentDivision">Divisi</div>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <div class="header">
          <h1 id="pageTitle">Dashboard</h1>
          <button class="logout-btn" id="logoutBtn">
            <i class="fas fa-sign-out-alt"></i> Logout
          </button>
        </div>

        <!-- Dashboard Page -->
        <div id="dashboardPage" class="page">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Selamat Datang di Sistem Kuisioner</h2>
            </div>
            <p>
              Silakan pilih divisi di menu sebelah kiri untuk melihat dan
              mengisi kuisioner.
            </p>

            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
                margin-top: 30px;
              "
            >
              <div class="card" style="text-align: center; padding: 20px">
                <i
                  class="fas fa-clipboard-check"
                  style="
                    font-size: 3rem;
                    color: var(--primary);
                    margin-bottom: 15px;
                  "
                ></i>
                <h3>Kuisioner Terisi</h3>
                <p
                  id="totalFilled"
                  style="font-size: 2rem; font-weight: bold; margin: 10px 0"
                >
                  0
                </p>
              </div>

              <div class="card" style="text-align: center; padding: 20px">
                <i
                  class="fas fa-users"
                  style="
                    font-size: 3rem;
                    color: var(--success);
                    margin-bottom: 15px;
                  "
                ></i>
                <h3>Total Pengguna</h3>
                <p
                  id="totalUsers"
                  style="font-size: 2rem; font-weight: bold; margin: 10px 0"
                >
                  0
                </p>
              </div>

              <div class="card" style="text-align: center; padding: 20px">
                <i
                  class="fas fa-building"
                  style="
                    font-size: 3rem;
                    color: var(--warning);
                    margin-bottom: 15px;
                  "
                ></i>
                <h3>Total Divisi</h3>
                <p style="font-size: 2rem; font-weight: bold; margin: 10px 0">
                  4
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Keuangan Page -->
        <div id="keuanganPage" class="page" style="display: none">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">
                Kuisioner Divisi Keuangan
                <span
                  id="keuanganAdminIndicator"
                  class="admin-indicator"
                  style="display: none"
                  >ADMIN VIEW</span
                >
              </h2>
              <button class="btn btn-primary" id="saveKeuangan">
                Simpan Jawaban
              </button>
            </div>

            <div id="keuanganQuestions"></div>
          </div>
        </div>

        <!-- Project Page -->
        <div id="projectPage" class="page" style="display: none">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">
                Kuisioner Divisi Project
                <span
                  id="projectAdminIndicator"
                  class="admin-indicator"
                  style="display: none"
                  >ADMIN VIEW</span
                >
              </h2>
              <button class="btn btn-primary" id="saveProject">
                Simpan Jawaban
              </button>
            </div>

            <div id="projectQuestions"></div>
          </div>
        </div>

        <!-- Humas Page -->
        <div id="humasPage" class="page" style="display: none">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">
                Kuisioner Divisi Humas
                <span
                  id="humasAdminIndicator"
                  class="admin-indicator"
                  style="display: none"
                  >ADMIN VIEW</span
                >
              </h2>
              <button class="btn btn-primary" id="saveHumas">
                Simpan Jawaban
              </button>
            </div>

            <div id="humasQuestions"></div>
          </div>
        </div>

        <!-- Teknik Page -->
        <div id="teknikPage" class="page" style="display: none">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">
                Kuisioner Divisi Teknik
                <span
                  id="teknikAdminIndicator"
                  class="admin-indicator"
                  style="display: none"
                  >ADMIN VIEW</span
                >
              </h2>
              <button class="btn btn-primary" id="saveTeknik">
                Simpan Jawaban
              </button>
            </div>

            <div id="teknikQuestions"></div>
          </div>
        </div>

        <!-- Admin Page -->
        <div id="adminPage" class="page" style="display: none">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Dashboard Admin</h2>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>No</th>
                    <th>Username</th>
                    <th>Divisi</th>
                    <th>Tanggal</th>
                    <th>Status</th>
                    <th>Aksi</th>
                  </tr>
                </thead>
                <tbody id="adminTableBody">
                  <!-- Data akan diisi oleh JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Manage Users Page -->
        <div id="manageUsersPage" class="page" style="display: none">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Kelola Akun Pengguna</h2>
              <button class="btn btn-success" id="addUserBtn">
                <i class="fas fa-plus"></i> Tambah Akun Baru
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>No</th>
                    <th>Username</th>
                    <th>Divisi</th>
                    <th>Dibuat Oleh</th>
                    <th>Aksi</th>
                  </tr>
                </thead>
                <tbody id="usersTableBody">
                  <!-- Data akan diisi oleh JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Profile Page (Admin Only) -->
        <div id="profilePage" class="page" style="display: none">
          <div class="card profile-card">
            <div class="profile-header">
              <div class="profile-avatar" id="profileAvatar">A</div>
              <div class="profile-info">
                <h3 id="profileUsername">Administrator</h3>
                <p id="profileDivision">Administrator</p>
              </div>
            </div>

            <form id="updateProfileForm">
              <div class="form-group">
                <label>Username Baru</label>
                <input
                  type="text"
                  id="newUsername"
                  class="form-control"
                  placeholder="Masukkan username baru"
                  required
                />
              </div>

              <div class="form-group">
                <label>Password Saat Ini</label>
                <input
                  type="password"
                  id="currentPassword"
                  class="form-control"
                  placeholder="Masukkan password saat ini"
                  required
                />
              </div>

              <div class="form-group">
                <label>Password Baru</label>
                <input
                  type="password"
                  id="newPassword"
                  class="form-control"
                  placeholder="Masukkan password baru (kosongkan jika tidak ingin mengubah)"
                />
              </div>

              <div class="form-group">
                <label>Konfirmasi Password Baru</label>
                <input
                  type="password"
                  id="confirmNewPassword"
                  class="form-control"
                  placeholder="Konfirmasi password baru"
                />
              </div>

              <div style="display: flex; gap: 10px">
                <button type="submit" class="btn btn-primary" style="flex: 1">
                  <i class="fas fa-save"></i> Simpan Perubahan
                </button>
                <button
                  type="button"
                  class="btn btn-danger"
                  style="flex: 1"
                  onclick="showPage('dashboard')"
                >
                  <i class="fas fa-times"></i> Batal
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Access Denied Page -->
        <div id="accessDeniedPage" class="page" style="display: none">
          <div class="access-denied">
            <i class="fas fa-exclamation-triangle"></i>
            <h2>Akses Ditolak</h2>
            <p>Anda tidak memiliki izin untuk mengakses halaman ini.</p>
            <button class="btn btn-primary" onclick="showPage('dashboard')">
              Kembali ke Dashboard
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-copyright">
          © 2025 Sistem Kuisioner Divisi. All rights reserved.
        </div>
        <div class="footer-links">
          <a href="#">Tentang</a>
          <span class="footer-divider">|</span>
          <a href="#">Bantuan</a>
          <span class="footer-divider">|</span>
          <a href="#">Kebijakan Privasi</a>
          <span class="footer-divider">|</span>
          <a href="#">Kontak</a>
        </div>
        <div
          class="footer-copyright"
          style="font-size: 0.8rem; margin-top: 5px"
        >
          Developed by Iway
        </div>
      </div>
    </footer>

    <!-- Notification -->
    <div id="notification" class="notification">
      <i class="fas fa-check-circle"></i>
      <span id="notificationText">Notifikasi</span>
    </div>

    <script>
      // Data storage
      let users = JSON.parse(localStorage.getItem("kuisionerUsers")) || [];
      let responses =
        JSON.parse(localStorage.getItem("kuisionerResponses")) || [];
      let currentUser = null;

      // Initialize admin account if it doesn't exist
      function initializeAdminAccount() {
        console.log("Initializing admin account...");
        console.log("Current users:", users);

        // Check if admin account exists
        const adminExists = users.some(
          (user) => user.username === "Administrator"
        );

        if (!adminExists) {
          // Create admin account
          const adminAccount = {
            id: 1,
            username: "Administrator",
            password: "AdminKuisioner",
            division: "admin",
            createdBy: "system",
            createdAt: new Date().toISOString(),
          };

          users.push(adminAccount);
          localStorage.setItem("kuisionerUsers", JSON.stringify(users));
          console.log("Admin account created successfully");
          console.log("Updated users:", users);
          return true;
        } else {
          console.log("Admin account already exists");
          return false;
        }
      }

      // Questions data
      const questionsData = {
        keuangan: [
          {
            id: "k1",
            question:
              "Bagaimana penilaian Anda terhadap efisiensi anggaran divisi keuangan?",
            options: [
              "Sangat Efisien",
              "Efisien",
              "Cukup Efisien",
              "Kurang Efisien",
              "Tidak Efisien",
            ],
            type: "radio",
          },
          {
            id: "k2",
            question:
              "Seberapa puas Anda dengan transparansi laporan keuangan?",
            options: [
              "Sangat Puas",
              "Puas",
              "Cukup Puas",
              "Kurang Puas",
              "Tidak Puas",
            ],
            type: "radio",
          },
          {
            id: "k3",
            question:
              "Fitur apa yang paling bermanfaat dari sistem keuangan kami?",
            options: [
              "Pengajuan anggaran",
              "Laporan real-time",
              "Pembayaran otomatis",
              "Audit internal",
              "Lainnya",
            ],
            type: "checkbox",
          },
        ],
        project: [
          {
            id: "p1",
            question:
              "Bagaimana penilaian Anda terhadap manajemen proyek saat ini?",
            options: [
              "Sangat Baik",
              "Baik",
              "Cukup Baik",
              "Kurang Baik",
              "Tidak Baik",
            ],
            type: "radio",
          },
          {
            id: "p2",
            question: "Seberapa efektif komunikasi antar tim dalam proyek?",
            options: [
              "Sangat Efektif",
              "Efektif",
              "Cukup Efektif",
              "Kurang Efektif",
              "Tidak Efektif",
            ],
            type: "radio",
          },
          {
            id: "p3",
            question:
              "Hambatan apa yang sering terjadi dalam pelaksanaan proyek?",
            options: [
              "Keterlambatan persetujuan",
              "Kurangnya sumber daya",
              "Perubahan scope",
              "Komunikasi tim",
              "Lainnya",
            ],
            type: "checkbox",
          },
        ],
        humas: [
          {
            id: "h1",
            question:
              "Bagaimana penilaian Anda terhadap kualitas layanan humas?",
            options: [
              "Sangat Baik",
              "Baik",
              "Cukup Baik",
              "Kurang Baik",
              "Tidak Baik",
            ],
            type: "radio",
          },
          {
            id: "h2",
            question:
              "Seberapa efektif strategi komunikasi yang telah diterapkan?",
            options: [
              "Sangat Efektif",
              "Efektif",
              "Cukup Efektif",
              "Kurang Efektif",
              "Tidak Efektif",
            ],
            type: "radio",
          },
          {
            id: "h3",
            question: "Media apa yang paling efektif untuk promosi kami?",
            options: [
              "Media sosial",
              "Website",
              "Email marketing",
              "Event offline",
              "Lainnya",
            ],
            type: "checkbox",
          },
        ],
        teknik: [
          {
            id: "t1",
            question:
              "Bagaimana penilaian Anda terhadap kualitas produk teknis?",
            options: [
              "Sangat Baik",
              "Baik",
              "Cukup Baik",
              "Kurang Baik",
              "Tidak Baik",
            ],
            type: "radio",
          },
          {
            id: "t2",
            question: "Seberapa cepat respon tim teknis terhadap masalah?",
            options: [
              "Sangat Cepat",
              "Cepat",
              "Cukup Cepat",
              "Kurang Cepat",
              "Tidak Cepat",
            ],
            type: "radio",
          },
          {
            id: "t3",
            question: "Fitur teknis apa yang perlu ditingkatkan?",
            options: [
              "Performa sistem",
              "Antarmuka pengguna",
              "Keamanan data",
              "Integrasi API",
              "Lainnya",
            ],
            type: "checkbox",
          },
        ],
      };

      // DOM Elements
      const loginPage = document.getElementById("loginPage");
      const registerForm = document.getElementById("registerForm");
      const appContainer = document.getElementById("appContainer");
      const loginFormElement = document.getElementById("loginForm");
      const registerFormElement = document.getElementById(
        "registerFormElement"
      );
      const updateProfileForm = document.getElementById("updateProfileForm");
      const sidebarMenu = document.getElementById("sidebarMenu");
      const pages = document.querySelectorAll(".page");
      const notification = document.getElementById("notification");
      const notificationText = document.getElementById("notificationText");

      // Initialize
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize admin account
        initializeAdminAccount();

        // Check if already logged in
        const savedUser = localStorage.getItem("currentUser");
        if (savedUser) {
          currentUser = JSON.parse(savedUser);
          showApp();
        }

        // Division selection for login
        const loginDivisionOptions = document.querySelectorAll(
          "#loginPage .division-option"
        );
        loginDivisionOptions.forEach((option) => {
          option.addEventListener("click", function () {
            loginDivisionOptions.forEach((opt) =>
              opt.classList.remove("selected")
            );
            this.classList.add("selected");
            document.getElementById("loginDivision").value =
              this.dataset.division;
          });
        });

        // Division selection for register
        const registerDivisionOptions = document.querySelectorAll(
          "#registerForm .division-option"
        );
        registerDivisionOptions.forEach((option) => {
          option.addEventListener("click", function () {
            registerDivisionOptions.forEach((opt) =>
              opt.classList.remove("selected")
            );
            this.classList.add("selected");
            document.getElementById("registerDivision").value =
              this.dataset.division;
          });
        });

        // Show register form
        document
          .getElementById("showRegisterForm")
          .addEventListener("click", function (e) {
            e.preventDefault();
            loginPage.style.display = "none";
            registerForm.style.display = "block";
          });

        // Cancel register
        document
          .getElementById("cancelRegister")
          .addEventListener("click", function () {
            registerForm.style.display = "none";
            loginPage.style.display = "block";
          });

        // Login form submission
        loginFormElement.addEventListener("submit", function (e) {
          e.preventDefault();

          const username = document.getElementById("loginUsername").value;
          const password = document.getElementById("loginPassword").value;
          const division = document.getElementById("loginDivision").value;

          // Debug info
          console.log("Login attempt:");
          console.log("Username:", username);
          console.log("Password:", password);
          console.log("Division:", division);
          console.log("Available users:", users);

          if (!division) {
            showNotification("Silakan pilih divisi terlebih dahulu", "error");
            return;
          }

          // Find user
          const user = users.find(
            (u) =>
              u.username === username &&
              u.password === password &&
              u.division === division
          );

          console.log("Found user:", user);

          if (user) {
            currentUser = user;
            localStorage.setItem("currentUser", JSON.stringify(user));
            showApp();
          } else {
            showNotification("Username, password, atau divisi salah", "error");
          }
        });

        // Register form submission
        registerFormElement.addEventListener("submit", function (e) {
          e.preventDefault();

          const username = document.getElementById("registerUsername").value;
          const password = document.getElementById("registerPassword").value;
          const confirmPassword = document.getElementById(
            "registerConfirmPassword"
          ).value;
          const division = document.getElementById("registerDivision").value;

          if (!division) {
            showNotification("Silakan pilih divisi terlebih dahulu", "error");
            return;
          }

          if (password !== confirmPassword) {
            showNotification(
              "Password dan konfirmasi password tidak cocok",
              "error"
            );
            return;
          }

          // Check if username already exists
          if (users.some((u) => u.username === username)) {
            showNotification("Username sudah digunakan", "error");
            return;
          }

          // Create new user
          const newUser = {
            id: Date.now(),
            username,
            password,
            division,
            createdBy: currentUser ? currentUser.username : "self",
            createdAt: new Date().toISOString(),
          };

          users.push(newUser);
          localStorage.setItem("kuisionerUsers", JSON.stringify(users));

          showNotification("Akun berhasil dibuat. Silakan login.");
          registerForm.style.display = "none";
          loginPage.style.display = "block";
          registerFormElement.reset();
        });

        // Update profile form submission
        updateProfileForm.addEventListener("submit", function (e) {
          e.preventDefault();

          const newUsername = document.getElementById("newUsername").value;
          const currentPassword =
            document.getElementById("currentPassword").value;
          const newPassword = document.getElementById("newPassword").value;
          const confirmNewPassword =
            document.getElementById("confirmNewPassword").value;

          // Validate current password
          if (currentPassword !== currentUser.password) {
            showNotification("Password saat ini salah", "error");
            return;
          }

          // Check if new username already exists (excluding current user)
          if (
            newUsername !== currentUser.username &&
            users.some((u) => u.username === newUsername)
          ) {
            showNotification(
              "Username sudah digunakan oleh pengguna lain",
              "error"
            );
            return;
          }

          // Validate new password if provided
          if (newPassword && newPassword !== confirmNewPassword) {
            showNotification(
              "Password baru dan konfirmasi password baru tidak cocok",
              "error"
            );
            return;
          }

          // Update user data
          const userIndex = users.findIndex((u) => u.id === currentUser.id);
          if (userIndex !== -1) {
            // Update username
            users[userIndex].username = newUsername;

            // Update password if provided
            if (newPassword) {
              users[userIndex].password = newPassword;
            }

            // Update localStorage
            localStorage.setItem("kuisionerUsers", JSON.stringify(users));

            // Update current user data
            currentUser.username = newUsername;
            if (newPassword) {
              currentUser.password = newPassword;
            }
            localStorage.setItem("currentUser", JSON.stringify(currentUser));

            // Update UI
            document.getElementById("currentUser").textContent =
              currentUser.username;
            document.getElementById("userAvatar").textContent =
              currentUser.username.charAt(0).toUpperCase();
            document.getElementById("profileUsername").textContent =
              currentUser.username;
            document.getElementById("profileAvatar").textContent =
              currentUser.username.charAt(0).toUpperCase();

            showNotification("Profil berhasil diperbarui!");

            // Reset form
            updateProfileForm.reset();
          }
        });

        // Sidebar menu
        sidebarMenu.addEventListener("click", function (e) {
          const menuItem = e.target.closest(".menu-item");
          if (menuItem) {
            const page = menuItem.dataset.page;

            // Check if user has access to this page
            if (!hasAccessToPage(page)) {
              showPage("accessDenied");
              return;
            }

            // Update active menu
            document.querySelectorAll(".menu-item").forEach((item) => {
              item.classList.remove("active");
            });
            menuItem.classList.add("active");

            // Show page
            showPage(page);
          }
        });

        // Logout button
        document
          .getElementById("logoutBtn")
          .addEventListener("click", function () {
            localStorage.removeItem("currentUser");
            currentUser = null;
            showLogin();
          });

        // Save buttons for each division
        document
          .getElementById("saveKeuangan")
          .addEventListener("click", () => saveResponses("keuangan"));
        document
          .getElementById("saveProject")
          .addEventListener("click", () => saveResponses("project"));
        document
          .getElementById("saveHumas")
          .addEventListener("click", () => saveResponses("humas"));
        document
          .getElementById("saveTeknik")
          .addEventListener("click", () => saveResponses("teknik"));

        // Add user button
        document
          .getElementById("addUserBtn")
          .addEventListener("click", function () {
            showPage("register");
          });
      });

      // Check if user has access to a specific page
      function hasAccessToPage(pageName) {
        if (!currentUser) return false;

        // Admin has access to all pages
        if (currentUser.division === "admin") {
          return true;
        }

        // Regular users only have access to their division and dashboard
        if (pageName === "dashboard") {
          return true;
        }

        // Check if the page matches the user's division
        return pageName === currentUser.division;
      }

      // Show app
      function showApp() {
        loginPage.style.display = "none";
        registerForm.style.display = "none";
        appContainer.style.display = "flex";

        // Update user info
        document.getElementById("currentUser").textContent =
          currentUser.username;
        document.getElementById("currentDivision").textContent =
          capitalizeFirstLetter(currentUser.division);
        document.getElementById("userAvatar").textContent = currentUser.username
          .charAt(0)
          .toUpperCase();

        // Show/hide menu items based on user division
        updateMenuVisibility();

        // Show dashboard
        showPage("dashboard");
        updateDashboardStats();

        // Render questions for each division
        renderQuestions("keuangan");
        renderQuestions("project");
        renderQuestions("humas");
        renderQuestions("teknik");

        // Render admin table
        renderAdminTable();

        // Render users table
        renderUsersTable();
      }

      // Update menu visibility based on user division
      function updateMenuVisibility() {
        // Hide all admin-only menus first
        document.querySelectorAll(".admin-only").forEach((el) => {
          el.style.display = "none";
        });

        // Show admin menus if user is admin
        if (currentUser.division === "admin") {
          document.querySelectorAll(".admin-only").forEach((el) => {
            el.style.display = "flex";
          });

          // Show all division menus for admin
          document.querySelectorAll(".division-menu").forEach((el) => {
            el.style.display = "flex";
          });
        } else {
          // For regular users, show only their division menu
          document.querySelectorAll(".division-menu").forEach((el) => {
            const division = el.dataset.division;
            if (division === currentUser.division) {
              el.style.display = "flex";
            } else {
              el.style.display = "none";
            }
          });
        }
      }

      // Show login
      function showLogin() {
        appContainer.style.display = "none";
        loginPage.style.display = "block";
        loginFormElement.reset();
      }

      // Show page
      function showPage(pageName) {
        // Hide all pages
        pages.forEach((page) => {
          page.style.display = "none";
        });

        // Show selected page
        const page = document.getElementById(pageName + "Page");
        if (page) {
          page.style.display = "block";
        }

        // Update page title
        const pageTitle = document.getElementById("pageTitle");
        if (pageTitle) {
          switch (pageName) {
            case "dashboard":
              pageTitle.textContent = "Dashboard";
              break;
            case "keuangan":
              pageTitle.textContent = "Divisi Keuangan";
              break;
            case "project":
              pageTitle.textContent = "Divisi Project";
              break;
            case "humas":
              pageTitle.textContent = "Divisi Humas";
              break;
            case "teknik":
              pageTitle.textContent = "Divisi Teknik";
              break;
            case "admin":
              pageTitle.textContent = "Dashboard Admin";
              break;
            case "manage-users":
              pageTitle.textContent = "Kelola Akun Pengguna";
              break;
            case "profile":
              pageTitle.textContent = "Ubah Profil";
              // Populate profile form
              document.getElementById("newUsername").value =
                currentUser.username;
              document.getElementById("profileUsername").textContent =
                currentUser.username;
              document.getElementById("profileDivision").textContent =
                capitalizeFirstLetter(currentUser.division);
              document.getElementById("profileAvatar").textContent =
                currentUser.username.charAt(0).toUpperCase();
              break;
            case "accessDenied":
              pageTitle.textContent = "Akses Ditolak";
              break;
          }
        }

        // Show admin indicators if user is admin and viewing a division page
        updateAdminIndicators(pageName);
      }

      // Update admin indicators on division pages
      function updateAdminIndicators(pageName) {
        // Hide all admin indicators first
        document.querySelectorAll(".admin-indicator").forEach((el) => {
          el.style.display = "none";
        });

        // Show admin indicator if user is admin and viewing a division page
        if (
          currentUser.division === "admin" &&
          ["keuangan", "project", "humas", "teknik"].includes(pageName)
        ) {
          const indicator = document.getElementById(
            pageName + "AdminIndicator"
          );
          if (indicator) {
            indicator.style.display = "inline-block";
          }
        }
      }

      // Render questions
      function renderQuestions(division) {
        const container = document.getElementById(division + "Questions");
        const questions = questionsData[division];

        if (!container || !questions) return;

        container.innerHTML = "";

        questions.forEach((q, index) => {
          const questionDiv = document.createElement("div");
          questionDiv.className = "question";

          const questionTitle = document.createElement("div");
          questionTitle.className = "question-title";
          questionTitle.textContent = `${index + 1}. ${q.question}`;

          const optionsDiv = document.createElement("div");
          optionsDiv.className = "options";

          q.options.forEach((option, optIndex) => {
            const optionLabel = document.createElement("label");
            optionLabel.className = "option";

            const input = document.createElement("input");
            input.type = q.type;
            input.name = `question-${q.id}`;
            input.value = option;

            const span = document.createElement("span");
            span.textContent = option;

            optionLabel.appendChild(input);
            optionLabel.appendChild(span);
            optionsDiv.appendChild(optionLabel);
          });

          questionDiv.appendChild(questionTitle);
          questionDiv.appendChild(optionsDiv);
          container.appendChild(questionDiv);
        });
      }

      // Save responses
      function saveResponses(division) {
        const questions = questionsData[division];
        const userResponses = [];

        questions.forEach((q) => {
          const selectedOptions = [];
          const inputs = document.querySelectorAll(
            `input[name="question-${q.id}"]:checked`
          );

          inputs.forEach((input) => {
            selectedOptions.push(input.value);
          });

          userResponses.push({
            questionId: q.id,
            question: q.question,
            answers: selectedOptions,
          });
        });

        // Check if all questions are answered
        const allAnswered = userResponses.every((r) => r.answers.length > 0);
        if (!allAnswered) {
          showNotification("Silakan jawab semua pertanyaan", "error");
          return;
        }

        // Save response
        const response = {
          id: Date.now(),
          userId: currentUser.id,
          username: currentUser.username,
          division,
          responses: userResponses,
          createdAt: new Date().toISOString(),
        };

        // Remove previous responses from same user for this division
        responses = responses.filter(
          (r) => !(r.userId === currentUser.id && r.division === division)
        );

        responses.push(response);
        localStorage.setItem("kuisionerResponses", JSON.stringify(responses));

        showNotification("Jawaban berhasil disimpan!");
        updateDashboardStats();
        renderAdminTable();
      }

      // Render admin table
      function renderAdminTable() {
        const tbody = document.getElementById("adminTableBody");
        if (!tbody) return;

        tbody.innerHTML = "";

        responses.forEach((response, index) => {
          const tr = document.createElement("tr");

          const user = users.find((u) => u.id === response.userId);

          tr.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${response.username}</td>
                    <td>${capitalizeFirstLetter(response.division)}</td>
                    <td>${formatDate(response.createdAt)}</td>
                    <td><span class="badge badge-success">Selesai</span></td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="viewResponse(${
                          response.id
                        })">
                            <i class="fas fa-eye"></i> Lihat
                        </button>
                    </td>
                `;

          tbody.appendChild(tr);
        });
      }

      // Render users table
      function renderUsersTable() {
        const tbody = document.getElementById("usersTableBody");
        if (!tbody) return;

        tbody.innerHTML = "";

        users.forEach((user, index) => {
          const tr = document.createElement("tr");

          tr.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${user.username}</td>
                    <td>${capitalizeFirstLetter(user.division)}</td>
                    <td>${user.createdBy}</td>
                    <td>
                        <button class="btn btn-sm btn-danger" onclick="deleteUser(${
                          user.id
                        })">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </td>
                `;

          tbody.appendChild(tr);
        });
      }

      // Update dashboard stats
      function updateDashboardStats() {
        document.getElementById("totalFilled").textContent = responses.length;
        document.getElementById("totalUsers").textContent = users.length;
      }

      // Show notification
      function showNotification(message, type = "success") {
        notificationText.textContent = message;

        if (type === "error") {
          notification.classList.add("error");
          notification.querySelector("i").className =
            "fas fa-exclamation-circle";
        } else {
          notification.classList.remove("error");
          notification.querySelector("i").className = "fas fa-check-circle";
        }

        notification.classList.add("show");

        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }

      // View response
      function viewResponse(responseId) {
        const response = responses.find((r) => r.id === responseId);
        if (!response) return;

        let html = `<h3>Detail Jawaban - ${
          response.username
        } (${capitalizeFirstLetter(response.division)})</h3>`;
        html += '<table class="table">';
        html +=
          "<thead><tr><th>Pertanyaan</th><th>Jawaban</th></tr></thead><tbody>";

        response.responses.forEach((r) => {
          html += `<tr>
                    <td>${r.question}</td>
                    <td>${r.answers.join(", ")}</td>
                </tr>`;
        });

        html += "</tbody></table>";

        // Create modal
        const modal = document.createElement("div");
        modal.style.position = "fixed";
        modal.style.top = "0";
        modal.style.left = "0";
        modal.style.width = "100%";
        modal.style.height = "100%";
        modal.style.backgroundColor = "rgba(0,0,0,0.5)";
        modal.style.display = "flex";
        modal.style.alignItems = "center";
        modal.style.justifyContent = "center";
        modal.style.zIndex = "1000";

        const modalContent = document.createElement("div");
        modalContent.style.backgroundColor = "white";
        modalContent.style.padding = "30px";
        modalContent.style.borderRadius = "10px";
        modalContent.style.maxWidth = "800px";
        modalContent.style.width = "90%";
        modalContent.style.maxHeight = "80vh";
        modalContent.style.overflowY = "auto";

        modalContent.innerHTML =
          html +
          '<button class="btn btn-danger" style="margin-top: 20px;">Tutup</button>';

        modal.appendChild(modalContent);
        document.body.appendChild(modal);

        // Close modal
        modalContent.querySelector("button").addEventListener("click", () => {
          document.body.removeChild(modal);
        });

        // Close when clicking outside
        modal.addEventListener("click", (e) => {
          if (e.target === modal) {
            document.body.removeChild(modal);
          }
        });
      }

      // Delete user
      function deleteUser(userId) {
        if (confirm("Apakah Anda yakin ingin menghapus pengguna ini?")) {
          users = users.filter((u) => u.id !== userId);
          localStorage.setItem("kuisionerUsers", JSON.stringify(users));

          // Also delete responses
          responses = responses.filter((r) => r.userId !== userId);
          localStorage.setItem("kuisionerResponses", JSON.stringify(responses));

          renderUsersTable();
          renderAdminTable();
          updateDashboardStats();

          showNotification("Pengguna berhasil dihapus");
        }
      }

      // Helper functions
      function capitalizeFirstLetter(string) {
        return string.charAt(0).toUpperCase() + string.slice(1);
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString("id-ID", {
          year: "numeric",
          month: "long",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });
      }
    </script>
  </body>
</html>
